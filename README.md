## 项目描述

## 准备工作
1. 准备UI界面
2. 准备项目搭建，项目用到：
  + react
  + react-redux
  + react-router
  + Ant-design

## 级联组件的制作封装
> 考虑做一个类似数字密码锁样式的滚筒UI，做法如下：
1. 视窗确定：
  + 使用`card`作为视图窗口，定位两根横线，横线中间的信息为选择项
  + 视窗分为两侧，左侧为一级选择器，右侧为二级选择器
2. 3D视图参数
  + `perspective`取400px，滚筒设定为最多显示5个数据，每个数据的角度差值为`30deg`，因此角度区间取值为`[-60°,60°]`
  + 每次滚动时，滚动角度为30°
3. 传入传出数据
  + 传入API为：obj
  + 传入数据考虑为对象，键名为一级选择器选项，值为一个数组，为二级选择器选项
  + 收到传入数据时，首先遍历数据对象，取出键并放入一个数组中，该数组前端有两个空元素，该数组用于填充选择器的左端
  + 考虑用两个`selected`开头的标识，也可以视为指针，来辅助指向选中的一、二级信息位于数组的位置，同时为选择器指出渲染的起始位置
  + 传出数据用数组形式，第一个元素为一级选择器内容，第二个为二级选择器内容
4. 动画实现，采用纯css实现
  + 因为用纯CSS实现的滚动效果，因此该版本无拖动滚动事件，考虑之后添加
  + 目前选择器有四个区域可以点击，分别控制一二级选择器进行上下滑动选择
  + 事件通过传入一个`ref`和`滚动事件`(上滚、下滚)，为目标选择器添加一个带动画的`className`，在动画结束后删除类名、更新选择器并渲染，**且为了防止同组件间的相互干扰**，**因此需要将selected放到state中**
  + 因为采用css动画，为了能在动画结束并删除后，正确显示选中的选项，需要进行更新`state`，设定一个函数`edit`，用于更新`selected`指针，更新完后并用副作用函数提供的方法`setState({...state})`更新一下组件
  + 然后就出现了**无限循环渲染**问题，因为`edit`还有个作用是更新完`selected`后，会将新的渲染数组包装成h5标签并给组件`render`，因此我在组件的初始化中便调用了该函数，于是乎初始化→更新→更新……停不下来
  + 在`edit`中加入一个条件，当传入第一个参数为0时，跳过更新渲染，直接返回当前指针指定的数组标签族，当为1时，对应选择器的`selected+1`、选择器上翻并且渲染更新，于是跳出了无限循环渲染
5. 数据处理
  + 对传入的`props`设置为该组件的`state`，并且给予对应的`setState`，取出键名作为一级选择器选项
  + 初次渲染和每次更新渲染时，用`useEffect`将选择器选中项，以数组的形式传给父组件
    +  然后，又出现了死循环，原因是通过`useEffect`向父组件传值，父组件更新连带着该组件`useEffect`被触发，从而陷入了循环

## 传值记录
1. `useContext`传值：
  + 单纯用于传值，不用`action reducer`修改的值
  + 设置了全局context，在`src`中生成了一个`globalContext`文件
  + 
## 思考
1. 项目色调为橘色和暗黄色
2. 风格偏向于卡片化+横条化，记账清晰明了，这样也有利于组件封装与复用的实现
3. 记账的数据应进行分类，考虑有：
  + 按时间分类，属性为`time`
  + 按收入支出分类，属性为`to/from`
  + 按账户分类，属性为`account`
  + 日期分类，属性为`date`

## 问题记录
1. 在antd的card组件中设置一个浮动组件，会出现被外面的组件占掉位置的情况
  + 推测是提供的组件没有触发BFC，通过给card组件设置overflow:hidden解决问题
2. key值的设置不能为random